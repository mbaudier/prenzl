<project>
	<loadproperties srcfile="${factory.dir}/factory.properties"/>
	
	<property name="src.dir" location="./src"/> 
	<property name="obj.dir" location="./obj"/> 
	<property name="dist.dir" location="./dist"/> 
	
	<property name="prenzljni.lib.dir" location="${factory.dir}/prenzljnilib"/>
		
	<macrodef name="gcc.compile">
		<attribute name="component"/>
		<sequential>
			<mkdir dir="${obj.dir}"/>
			<echo message="Compile @{component}..."/>
			<exec executable="${gcc.bin.dir}/g++.exe" dir="." failonerror="true">
				<env key="Path" path="${gcc.bin.dir}"/>
				<arg line="-D_REENTRANT -D_GNU_SOURCE -D__int64=&quot;long long&quot; -O3 -Wall -c -fmessage-length=0  -mno-cygwin"/>
				<arg line="-I${factory.dir}\include\jdk-1.4.1\win32 -I${factory.dir}\include\jdk-1.4.1 -I..\.."/>
				<arg line="-o${obj.dir}/@{component}.o ${src.dir}/@{component}.cpp"/>
			</exec>
		</sequential>
	</macrodef>
	
	<macrodef name="gcc.link.rule">
		<attribute name="component"/>
		<attribute name="output"/>
		<sequential>
			<mkdir dir="${dist.dir}"/>
			<echo message="Link @{component} to @{output}..."/>
			<exec executable="${gcc.bin.dir}/g++.exe" dir=".">
				<env key="Path" path="${gcc.bin.dir}"/>
				<arg line="-mno-cygwin -Wl,--add-stdcall-alias -shared"/>
				<arg line="-L&quot;${prenzljni.lib.dir}&quot;"/>
				<arg line="-o${dist.dir}/@{output} ${obj.dir}/@{component}.o"/>
				<arg line="-lprenzl"/>
			</exec>
		</sequential>
	</macrodef>
	
	<macrodef name="clean">
		<sequential>
			<delete dir="${obj.dir}"/>
			<delete dir="${dist.dir}"/>
		</sequential>
	</macrodef>
</project>